{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "definitions": {
    "genericSchema": {
      "title": "Schema",
      "description": "A schema for this resource.",
      "oneOf": [
        { "type": "string" },
        { "type": "object" }
      ]
    },
    "tableSchema": {
      "title": "Table Schema",
      "description": "A Table Schema for this resource.",
      "oneOf": [
        { "type": "string" },
        {
          "type": "object",
          "required": [ "fields" ],
          "properties": {
            "fields": {
              "type": "array",
              "minItems": 1,
              "items": { "$ref": "#/definitions/tableSchemaField" }
            },
            "primaryKey": {
              "oneOf": [ { "type": "string" }, { "type": "array" } ]
            },
            "foreignKeys": {
              "type": "array",
              "minItems": 1,
              "items": { "$ref": "#/definitions/tableSchemaForeignKey" }
            }
          }
        }
      ]
    },
    "tableSchemaField": {
      "title": "Table Schema Field",
      "description": "Table Schema Field",
      "type": "object",
      "required": [ "name" ],
      "properties": {
        "name": { "type": "string" },
        "title": { "type": "string" },
        "description": { "type": "string" },
        "type": {
          "enum": [
            "string",
            "number",
            "integer",
            "date",
            "time",
            "datetime",
            "boolean",
            "object",
            "geopoint",
            "geojson",
            "array",
            "duration",
            "any"
          ]
        },
        "format": { "type": "string" },
        "rdfType": {"type": "string" },
        "constraints": { "$ref": "#/definitions/tableSchemaFieldConstraints" }
      }
    },
    "tableSchemaFieldConstraints": {
      "title": "Table Schema Field Constraints",
      "description": "Table Schema Field Constraints",
      "type": "object",
      "properties": {
        "required": { "type": "boolean" },
        "minLength": { "type": "integer" },
        "maxLength": { "type": "integer" },
        "unique": { "type": "boolean" },
        "pattern": { "type": "string" },
        "minimum": {
          "oneOf": [ { "type": "string" }, { "type": "number" } ]
        },
        "maximum": {
          "oneOf": [ {"type": "string"}, {"type": "number"} ]
        },
        "enum": { "type": "array", "minItems": 1, "uniqueItems": true }
      }
    },
    "tableSchemaForeignKey": {
      "title": "Table Schema Foreign Key",
      "description": "Table Schema Foreign Key",
      "type": "object",
      "required": [ "fields", "reference" ],
      "properties": {
        "fields": { "oneOf": [ { "type": "string" }, { "type": "array" } ] },
        "reference": {
          "type": "object",
          "required": [ "resource", "fields" ],
          "properties": {
            "resource": { "type": "string" },
            "fields": { "oneOf": [ { "type": "string" }, { "type": "array" } ] }
          }
        }
      }
    },
    "csvDialect": {
      "title": "CSV Dialect",
      "description": "The CSV dialect descriptor.",
      "type": "object",
      "properties": {
        "delimiter": {  "type": "string" },
        "doublequote": { "type": "boolean" },
        "lineterminator": {  "type": "string" },
        "quotechar": { "type": "string" },
        "skipinitialspace": { "type": "boolean" }
      },
      "required": [ "delimiter", "doublequote", "lineterminator", "quotechar", "skipinitialspace" ]
    },
    "baseDescriptor": {
      "title": "Base Descriptor",
      "description": "A Base Descriptor JSON Schemas",
      "type": "object",
      "required": [ "name" ],
      "items": {
        "properties": {
          "name": {
            "$ref": "dictionary.json#/definitions/name",
            "propertyOrder": 10
          },
          "title": {
            "$ref": "dictionary.json#/definitions/title",
            "propertyOrder": 20
          },
          "description": {
            "$ref": "dictionary.json#/definitions/description",
            "propertyOrder": 30,
            "format": "textarea"
          },
          "web": {
            "$ref": "dictionary.json#/definitions/web",
            "propertyOrder": 40
          },
          "sources": {
            "$ref": "dictionary.json#/definitions/sources",
            "propertyOrder": 140,
            "options": { "hidden": true }
          },
          "licenses": {
            "$ref": "dictionary.json#/definitions/license",
            "description": "The license under which the resource is published.",
            "propertyOrder": 150,
            "options": { "hidden": true }
          }
        }
      }
    },
    "baseDataResource": {
      "title": "Base Data Resource",
      "description": "Base Data Resource.",
      "type": "object",
      "items": {
        "allOf": [
          { "$ref": "#/definitions/baseDescriptor" },
          {
            "properties": {
              "path": {
                "$ref": "dictionary.json#/definitions/path",
                "propertyOrder": 60
              },
              "data": {
                "$ref": "dictionary.json#/definitions/data",
                "propertyOrder": 70
              },
              "schema": {
                "$ref": "#/definitions/genericSchema",
                "propertyOrder": 40
              },
              "format": {
                "$ref": "dictionary.json#/definitions/format",
                "propertyOrder": 80
              },
              "mediatype": {
                "$ref": "dictionary.json#/definitions/mediatype",
                "propertyOrder": 90
              },
              "encoding": {
                "$ref": "dictionary.json#/definitions/encoding",
                "propertyOrder": 100
              },
              "bytes": {
                "$ref": "dictionary.json#/definitions/bytes",
                "propertyOrder": 110,
                "options": { "hidden": true }
              },
              "hash": {
                "$ref": "dictionary.json#/definitions/hash",
                "propertyOrder": 120,
                "options": { "hidden": true }
              }
            }
          }
        ]
      }
    },
    "dataResource": {
      "title": "Data Resource",
      "description": "A Data Resource.",
      "type": "object",
      "items": {
        "allOf": [
          { "$ref": "#/definitions/baseDataResource" },
          {
            "properties": {
              "schema": {
                "$ref": "#/definitions/genericSchema",
                "propertyOrder": 40
              }
            }
          }
        ]
      }
    },
    "tabularDataResource": {
      "title": "Tabular Data Resource",
      "description": "A Tabular Data Resource.",
      "type": "object",
      "required": [ "name", "schema" ],
      "items": {
        "allOf": [
          { "$ref": "#/definitions/baseDataResource" },
          {
            "required": [ "schema" ],
            "properties": {
              "schema": {
                "$ref": "#/definitions/tableSchema",
                "propertyOrder": 40
              }
            }
          }
        ]
      }
    },
    "dataResources": {
      "title": "Data Resources",
      "description": "A list of Data Resources.",
      "type": "array",
      "minItems": 0,
      "items": { "$ref": "#/definitions/dataResource" }
    },
    "tabularDataResources": {
      "title": "Tabular Data Resources",
      "description": "A list of Tabular Data Resources.",
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/definitions/tabularDataResource" }
    },
    "fiscalMeasure": {
      "title": "Measure",
      "description": "Measure.",
      "type": "object",
      "required": [ "source", "currency" ],
      "properties": {
        "source": { "type": "string" },
        "resource": { "type": "string" },
        "currency": { "type": "string", "pattern": "^[A-Z]{3}$" },
        "factor": { "type": "number" },
        "direction": {
          "title": "Direction of the spending",
          "description": "A keyword that represents the direction of the spend, either expenditure or revenue.",
          "type": "string",
          "enum": [ "expenditure", "revenue" ]
        },
        "phase": {
          "title": "Budget phase",
          "description": "A keyword that represents the phase of the data, can be proposed for a budget proposal, approved for an approved budget, adjusted for modified budget or executed for the enacted budget",
          "type": "string",
          "enum": ["proposed", "approved", "adjusted", "executed"]
        }
      }
    },
    "fiscalDimension": {
      "title": "Dimension",
      "description": "Dimension.",
      "type": "object",
      "required": [ "attributes", "primaryKey" ],
      "properties": {
        "attributes": {
          "title": "Attributes",
          "description": "Attribute objects that make up the dimension",
          "type": "object",
          "minItems": 1,
          "patternProperties": {
            "^\\w+": {
              "type": "object",
              "properties": {
                "source": { "type": "string" },
                "resource": { "type": "string" },
                "constant": {
                  "oneOf": [
                    { "type": "string" },
                    { "type": "number" }
                  ]
                },
                "parent": { "type": "string" },
                "labelfor": { "type": "string" }
              },
              "required": [ "source" ]
            }
          }
        },
        "primaryKey": {
          "title": "Primary Key",
          "description": "Either an array of strings corresponding to the name attributes in a set of field objects in the fields array or a single string corresponding to one of these names. The value of primaryKey indicates the primary key or primary keys for the dimension.",
          "oneOf": [
            { "type": "string" },
            { "type": "array", "minItems": 1, "items": { "type": "string" } }
          ]
        },
        "dimensionType": {
          "title": "Dimension Type",
          "description": "Describes what kind of a dimension it is.",
          "type": "string",
          "enum": [
            "datetime",
            "entity",
            "classification",
            "activity",
            "fact",
            "location",
            "other"
          ]
        },
        "classificationType": {
          "title": "Classification Type",
          "description": "The type of the classification.",
          "enum": [ "functional", "administrative", "economic" ]
        }
      }
    },
    "fiscalModel": {
      "title": "",
      "description": "",
      "type": "",
      "required": [ "measures", "dimensions" ],
      "properties": {
        "measures": {
          "title": "Measures",
          "description": "Measures are numerical and correspond to financial amounts in the source data.",
          "type": "object",
          "patternProperties": { "^\\w+": { "$ref": "#/definitions/fiscalMeasure" } }
        },
        "dimensions": {
          "title": "Dimensions",
          "description": "Dimensions are groups of related fields. Dimensions cover all items other than the measure.",
          "type": "object",
          "patternProperties": { "^\\w+": { "$ref": "#/definitions/fiscalDimension" } }
        }
      }
    }
  }
}
